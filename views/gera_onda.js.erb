var ysDeCadaFrame = <%=@ys%>;
var delay = <%=@delay%>;

Context = function(_canvas,lineWidth,strokeStyle) {
  var canvas = _canvas;
  var elemento = canvas.getContext("2d");
  elemento.lineWidth = lineWidth;
  elemento.strokeStyle = strokeStyle;

  this.limpar = function(){
    elemento.clearRect(0,0,canvas.width,canvas.height);
  }
  
  this.tracarLinhaCentralizandoVerticalmente = function(ponto1,ponto2){
    elemento.moveTo(ponto1.x,ponto1.y + canvas.height/2);
    elemento.lineTo(ponto2.x,ponto2.y + canvas.height/2);
  }

  this.resetarTracos = function(){
    elemento.beginPath();
  }

  this.riscarLinhas = function() {
    elemento.stroke();
  }

}

Ponto = function(_x,_y) {
  this.x = _x;
  this.y = _y;
}

var canvas = document.getElementById("canvas");
var context = new Context(canvas,5,"#0000ff");

i = 0;
function animarOndaCom(ysDeCadaFrame) {
  context.limpar();
  var ysDoFrameAtual = ysDeCadaFrame[i%ysDeCadaFrame.length];
  desenharFrameCom(ysDoFrameAtual);
  i++;
}

function desenharFrameCom(ys) {
  context.resetarTracos();
  for(var x = 0 ; x < ys.length ; x++) {
    var ponto1 = new Ponto(x,ys[x]);
    var ponto2 = new Ponto(x+1,ys[x+1]);
    context.tracarLinhaCentralizandoVerticalmente(ponto1,ponto2);
  }
  context.riscarLinhas();
}

setInterval("animarOndaCom(ysDeCadaFrame)",delay);
